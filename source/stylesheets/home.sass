@keyframes welcome-text
  0%
    opacity: 0
    transform: translate3d(0, 10%, 0)

  100%
    transform: none
    opacity: 1

@keyframes hide-welcome-text
  0%
    transform: none
    opacity: 1

  100%
    opacity: 0
    transform: translate3d(0, 10%, 0)

.welcome-image
  background: var(--header-background-color)
  color: var(--header-text-color)
  height: 100vh
  height: 100svh
  left: 0
  position: relative
  text-align: center
  top: calc(var(--header-height) * -1)
  width: 100%
  display: flex
  align-items: center
  z-index: 2
  flex-shrink: 0

  .welcome-image-bg
    transition: opacity .3s ease-in
    object-fit: cover
    position: absolute
    top: 0
    left: 0
    width: 100%
    height: 100%
    opacity: 0

  .welcome-overlay
    background: var(--header-background-color)
    bottom: 0
    height: 100%
    left: 0
    position: absolute
    right: 0
    top: 0
    width: 100%
    // Background color based on brightening or darkening
    background: #{"{% if theme.welcome_overlay_opacity == 'very_bright' or theme.welcome_overlay_opacity == 'bright' %} white {% else %} black {% endif %}"}
    // Handle each specific case
    opacity: #{"{% if theme.welcome_overlay_opacity == 'very_bright' %} 0.8 {% endif %}"}
    opacity: #{"{% if theme.welcome_overlay_opacity == 'bright' %} 0.3 {% endif %}"}
    opacity: #{"{% if theme.welcome_overlay_opacity == 'none' %} 0 {% endif %}"}
    opacity: #{"{% if theme.welcome_overlay_opacity == 'dark' %} 0.4 {% endif %}"}
    opacity: #{"{% if theme.welcome_overlay_opacity == 'very_dark' %} 0.7 {% endif %}"}

  .welcome-text
    position: relative
    animation: welcome-text ease-in 900ms forwards
    padding: 0 20px
    max-width: 1200px
    margin: 0 auto

    &.fade_out
      animation: hide-welcome-text ease-in 200ms forwards

    .welcome-text-header
      font-family: var(--primary-font)
      font-size: 3.75em
      line-height: 1.2em
      margin-bottom: 40px

      @media screen and (max-width: $break-small)
        font-size: 2.75em

    .welcome-button
      color: var(--header-text-color)
      font-size: 1.5em
      padding: 10px
      text-decoration-color: transparent
      transition: text-decoration-color .1s linear
      outline-offset: 4px

      &:hover
        text-decoration-color: var(--header-text-color)
        text-decoration: underline
        text-decoration-thickness: 1px

      @media screen and (max-width: $break-small)
        font-size: 1.3em

.welcome-image + main
  margin-top: calc(var(--header-height) * -1)

.welcome-clickable
  cursor: pointer

.home-tagline
  color: var(--secondary-text-color)
  font-family: var(--secondary-font)
  font-size: 1.25em
  margin: 0 auto 96px
  max-width: 680px
  text-align: center
  width: 100%

  @media screen and (max-width: $break-small)
    margin: 0 auto 60px

.home-featured-products
  margin-bottom: var(--margin-size)

  .page-title
    margin-bottom: 0

    &--primary,
    &--secondary
      font-size: inherit

a.all-products-button
  margin-top: 48px

.featured-categories
  margin-bottom: 80px

  .featured-categories-header
    text-align: center
    margin-bottom: 48px

    &--primary
      font-size: 2rem
    
    &--secondary
      font-size: 1.5rem

  .category-list
    --columns: #{"{{ theme.max_categories_per_row }}"}
    max-width: #{"{% if theme.max_categories_per_row == 1 or theme.max_categories_per_row == 2 %}800px{% else %}none{% endif %}"}
    margin: #{"{% if theme.max_categories_per_row == 1 or theme.max_categories_per_row == 2 %}0 auto{% else %}0{% endif %}"}
    
    // Apply centering and reduce gap for 1-2 categories on desktop
    @media screen and (min-width: calc($break-small + 1px))
      justify-content: #{"{% if theme.max_categories_per_row == 1 or theme.max_categories_per_row == 2 %}center{% else %}flex-start{% endif %}"}

    @media screen and (max-width: $break-large)
      --columns: #{"{% if theme.max_categories_per_row > 3 %}calc(#{"{{ theme.max_categories_per_row }}"} - 1){% else %}{{ theme.max_categories_per_row }}{% endif %}"}

    @media screen and (max-width: $break-small)
      --columns: #{"{{ theme.max_categories_per_row_mobile }}"}

    &--text
      row-gap: calc(var(--spacing-unit) * 4)
      --gap: calc(var(--spacing-unit) * 3)

      @media screen and (max-width: $break-small)
        row-gap: calc(var(--spacing-unit) * 2)

      // Allow natural button width for better centering when 1-2 categories per row
      .product-list-thumb
        @media screen and (min-width: calc($break-small + 1px))
          width: #{"{% if theme.max_categories_per_row == 1 or theme.max_categories_per_row == 2 %}auto{% else %}calc((100% / var(--columns)) - var(--gap) + (var(--gap) / var(--columns))){% endif %}"}
    
    a.button
      display: block
      white-space: nowrap
      overflow: hidden
      text-overflow: ellipsis
      text-align: center
      // Center buttons within their containers for 1-2 categories per row
      margin: #{"{% if theme.max_categories_per_row == 1 or theme.max_categories_per_row == 2 %}0 auto{% else %}0{% endif %}"}

  // Keyframes for fade-in animation
@keyframes fade-in
  from
    opacity: 0
  to
    opacity: 1

// Styles for collage image fade-in using animation
.collage-image
  // Final state is opacity 1 by default
  opacity: 1
  // Apply animation when NOT loading
  animation: fade-in 0.4s ease-in-out forwards

  // Add a 'loading' state for when the image is not yet ready
  &.loading
    // Start invisible and prevent animation from running initially
    opacity: 0
    animation: none

// Video player theme-specific override
.home-featured-video-section
  margin-top: #{"{% if theme.images.welcome_image == blank and theme.welcome_text == blank and theme.welcome_button_text == blank %}0{% else %}calc(var(--margin-size) / 2){% endif %}"}

#main
  .featured-container
    font-size: 1rem

    @media screen and (max-width: $break-medium)
      font-size: 0.95rem

    .page-title
      font-size: 2em

  .featured-message
    text-align: center
    margin: 20px auto 60px auto
    padding: 0 1.5rem

    ol, ul
      text-align: left
      margin: 1em auto
      max-width: 600px
      padding-left: 2.5em

      ol, ul
        margin: 0.5em 0
        padding-left: 1.5em

    ul
      list-style: disc

    ol
      list-style: decimal

    a
      text-decoration: underline
      text-underline-offset: 3px

    img
      display: inline-block
      max-width: 100%
      margin: 0 auto
      padding-bottom: 16px
    
    iframe
      display: block
      margin: 0 auto
      max-width: 100%
      margin-bottom: 16px
